# Cloudflare Worker Configuration for Material Changes API

name = "material-changes-api"
main = "src/index.py"
compatibility_date = "2024-01-01"

# Python Workers configuration
[python]
# Use Python 3.11+
runtime = "python-3.11"

# Environment variables (use wrangler secret for sensitive values)
[vars]
ENVIRONMENT = "production"

# Secrets (set via: wrangler secret put SECRET_NAME)
# - SUPABASE_URL
# - SUPABASE_SERVICE_ROLE_KEY
# - FRONTEND_URL (for CORS)

# R2 Bucket binding for market data
[[r2_buckets]]
binding = "BUCKET"
bucket_name = "market-data"

# Worker configuration
[build]
command = ""  # No build step needed for Python

# Limits and configuration
[limits]
cpu_ms = 50  # CPU time limit per request (milliseconds)

# Routes (configure after deployment)
# [route]
# pattern = "api.materialchanges.com/*"
# zone_name = "materialchanges.com"

# Development configuration
[env.development]
name = "material-changes-api-dev"
vars = { ENVIRONMENT = "development" }

# Staging configuration
[env.staging]
name = "material-changes-api-staging"
vars = { ENVIRONMENT = "staging" }
